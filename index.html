<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Hospital Management System - Patient Portal</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link
      href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap"
      rel="stylesheet"
    />
    <style>
      body {
        font-family: "Poppins", sans-serif;
        background-color: #f0f4f8;
      }
      .form-section {
        display: none;
      }
      .form-section.active {
        display: block;
      }
      .doctor-card:hover {
        transform: translateY(-5px);
        box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1),
          0 4px 6px -2px rgba(0, 0, 0, 0.05);
      }
      .time-slot {
        transition: all 0.3s ease;
      }
      .time-slot:hover:not(.booked):not(.disabled) {
        background-color: #dbeafe;
      }
      .time-slot.selected {
        background-color: #3b82f6;
        color: white;
      }
      .time-slot.booked {
        background-color: #f3f4f6;
        color: #9ca3af;
        cursor: not-allowed;
      }
      .time-slot.disabled {
        background-color: #e5e7eb;
        color: #9ca3af;
        cursor: not-allowed;
      }
    </style>
  </head>
  <body>
    <div class="min-h-screen">
      <!-- Main Navigation -->
      <div
        class="bg-gradient-to-r from-blue-600 to-blue-800 text-white p-4 shadow-md"
      >
        <div class="container mx-auto flex justify-between items-center">
          <div class="flex items-center space-x-2">
            <svg
              xmlns="http://www.w3.org/2000/svg"
              class="h-8 w-8"
              fill="none"
              viewBox="0 0 24 24"
              stroke="currentColor"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"
              />
            </svg>
            <h1 class="text-2xl font-bold">Yashoda Hospital</h1>
          </div>
          <div class="flex space-x-4">
            <button
              id="patient-portal-btn"
              class="px-4 py-2 rounded-lg font-medium transition-all bg-blue-700"
            >
              Patient Portal
            </button>
          </div>
        </div>
      </div>

      <!-- Patient Portal -->
      <div id="patient-portal" class="container mx-auto py-8 px-4">
        <!-- Progress Bar -->
        <div class="mb-8">
          <div class="flex justify-between mb-2">
            <span id="step1-label" class="font-medium text-blue-600"
              >Personal Details</span
            >
            <span id="step2-label" class="font-medium text-gray-400"
              >Medical Information</span
            >
            <span id="step3-label" class="font-medium text-gray-400"
              >Doctor Selection</span
            >
            <span id="step4-label" class="font-medium text-gray-400"
              >Confirmation</span
            >
          </div>
          <div class="w-full bg-gray-200 rounded-full h-2.5">
            <div
              id="progress-bar"
              class="bg-blue-600 h-2.5 rounded-full"
              style="width: 25%"
            ></div>
          </div>
        </div>

        <!-- Form Sections -->
        <div id="patient-form-container">
          <!-- Step 1: Personal Details -->
          <div id="step1" class="form-section active">
            <div class="bg-white rounded-lg shadow-md p-6 mb-6">
              <h2 class="text-xl font-semibold mb-4 text-gray-800">
                Personal Information
              </h2>
              <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <div>
                  <label
                    for="fullName"
                    class="block text-sm font-medium text-gray-700 mb-1"
                    >Full Name</label
                  >
                  <input
                    type="text"
                    id="fullName"
                    class="w-full px-4 py-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500"
                    placeholder="Enter your full name"
                    required
                  />
                </div>
                <div>
                  <label
                    for="age"
                    class="block text-sm font-medium text-gray-700 mb-1"
                    >Age</label
                  >
                  <input
                    type="number"
                    id="age"
                    class="w-full px-4 py-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500"
                    placeholder="Enter your age"
                    required
                  />
                </div>
                <div>
                  <label
                    for="gender"
                    class="block text-sm font-medium text-gray-700 mb-1"
                    >Gender</label
                  >
                  <select
                    id="gender"
                    class="w-full px-4 py-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500"
                    required
                  >
                    <option value="" disabled selected>Select gender</option>
                    <option value="male">Male</option>
                    <option value="female">Female</option>
                    <option value="other">Other</option>
                  </select>
                </div>
                <div>
                  <label
                    for="phone"
                    class="block text-sm font-medium text-gray-700 mb-1"
                    >Phone Number</label
                  >
                  <input
                    type="tel"
                    id="phone"
                    class="w-full px-4 py-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500"
                    placeholder="Enter your phone number"
                    required
                  />
                </div>
                <div>
                  <label
                    for="email"
                    class="block text-sm font-medium text-gray-700 mb-1"
                    >Email Address</label
                  >
                  <input
                    type="email"
                    id="email"
                    class="w-full px-4 py-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500"
                    placeholder="Enter your email address"
                    required
                  />
                </div>
                <div>
                  <label
                    for="address"
                    class="block text-sm font-medium text-gray-700 mb-1"
                    >Address</label
                  >
                  <input
                    type="text"
                    id="address"
                    class="w-full px-4 py-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500"
                    placeholder="Enter your address"
                    required
                  />
                </div>
              </div>
            </div>

            <div class="bg-white rounded-lg shadow-md p-6">
              <h2 class="text-xl font-semibold mb-4 text-gray-800">
                Physical Information
              </h2>
              <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                <div>
                  <label
                    for="height"
                    class="block text-sm font-medium text-gray-700 mb-1"
                    >Height (cm)</label
                  >
                  <input
                    type="number"
                    id="height"
                    class="w-full px-4 py-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500"
                    placeholder="Enter height in cm"
                    required
                  />
                </div>
                <div>
                  <label
                    for="weight"
                    class="block text-sm font-medium text-gray-700 mb-1"
                    >Weight (kg)</label
                  >
                  <input
                    type="number"
                    id="weight"
                    class="w-full px-4 py-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500"
                    placeholder="Enter weight in kg"
                    required
                  />
                </div>
                <div>
                  <label
                    for="bloodGroup"
                    class="block text-sm font-medium text-gray-700 mb-1"
                    >Blood Group</label
                  >
                  <select
                    id="bloodGroup"
                    class="w-full px-4 py-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500"
                    required
                  >
                    <option value="" disabled selected>
                      Select blood group
                    </option>
                    <option value="A+">A+</option>
                    <option value="A-">A-</option>
                    <option value="B+">B+</option>
                    <option value="B-">B-</option>
                    <option value="AB+">AB+</option>
                    <option value="AB-">AB-</option>
                    <option value="O+">O+</option>
                    <option value="O-">O-</option>
                  </select>
                </div>
              </div>
            </div>

            <div class="mt-6 flex justify-end">
              <button
                id="next-to-step2"
                class="bg-blue-600 hover:bg-blue-700 text-white font-medium py-2 px-6 rounded-md transition-all"
              >
                Next
              </button>
            </div>
          </div>

          <!-- Step 2: Medical Information -->
          <div id="step2" class="form-section">
            <div class="bg-white rounded-lg shadow-md p-6 mb-6">
              <h2 class="text-xl font-semibold mb-4 text-gray-800">
                Medical History
              </h2>
              <div class="mb-6">
                <p class="text-sm font-medium text-gray-700 mb-2">
                  Do you have any of the following medical conditions?
                </p>
                <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                  <div class="flex items-center">
                    <input
                      type="checkbox"
                      id="condition-bp"
                      class="w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500"
                    />
                    <label for="condition-bp" class="ml-2 text-sm text-gray-700"
                      >High Blood Pressure</label
                    >
                  </div>
                  <div class="flex items-center">
                    <input
                      type="checkbox"
                      id="condition-diabetes"
                      class="w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500"
                    />
                    <label
                      for="condition-diabetes"
                      class="ml-2 text-sm text-gray-700"
                      >Diabetes</label
                    >
                  </div>
                  <div class="flex items-center">
                    <input
                      type="checkbox"
                      id="condition-asthma"
                      class="w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500"
                    />
                    <label
                      for="condition-asthma"
                      class="ml-2 text-sm text-gray-700"
                      >Asthma</label
                    >
                  </div>
                  <div class="flex items-center">
                    <input
                      type="checkbox"
                      id="condition-thyroid"
                      class="w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500"
                    />
                    <label
                      for="condition-thyroid"
                      class="ml-2 text-sm text-gray-700"
                      >Thyroid Disorder</label
                    >
                  </div>
                  <div class="flex items-center">
                    <input
                      type="checkbox"
                      id="condition-heart"
                      class="w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500"
                    />
                    <label
                      for="condition-heart"
                      class="ml-2 text-sm text-gray-700"
                      >Heart Disease</label
                    >
                  </div>
                  <div class="flex items-center">
                    <input
                      type="checkbox"
                      id="condition-arthritis"
                      class="w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500"
                    />
                    <label
                      for="condition-arthritis"
                      class="ml-2 text-sm text-gray-700"
                      >Arthritis</label
                    >
                  </div>
                </div>
              </div>

              <div class="mb-6">
                <label
                  for="allergies"
                  class="block text-sm font-medium text-gray-700 mb-1"
                  >Do you have any allergies?</label
                >
                <input
                  type="text"
                  id="allergies"
                  class="w-full px-4 py-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500"
                  placeholder="List any allergies (if none, write 'None')"
                />
              </div>

              <div>
                <label
                  for="medications"
                  class="block text-sm font-medium text-gray-700 mb-1"
                  >Current Medications</label
                >
                <input
                  type="text"
                  id="medications"
                  class="w-full px-4 py-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500"
                  placeholder="List any medications you're currently taking (if none, write 'None')"
                />
              </div>
            </div>

            <div class="bg-white rounded-lg shadow-md p-6">
              <h2 class="text-xl font-semibold mb-4 text-gray-800">
                Current Medical Condition
              </h2>
              <div>
                <label
                  for="currentCondition"
                  class="block text-sm font-medium text-gray-700 mb-1"
                  >Please describe your current medical issue</label
                >
                <textarea
                  id="currentCondition"
                  rows="4"
                  class="w-full px-4 py-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500"
                  placeholder="Describe your symptoms, when they started, and any other relevant information"
                  required
                ></textarea>
              </div>
              <div class="mt-4">
                <label
                  for="painLevel"
                  class="block text-sm font-medium text-gray-700 mb-1"
                  >Pain Level (if applicable)</label
                >
                <div class="flex items-center space-x-2">
                  <input
                    type="range"
                    id="painLevel"
                    min="0"
                    max="10"
                    value="0"
                    class="w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer"
                  />
                  <span id="painLevelValue" class="text-sm font-medium">0</span>
                </div>
                <div class="flex justify-between text-xs text-gray-500 mt-1">
                  <span>No Pain</span>
                  <span>Severe Pain</span>
                </div>
              </div>
            </div>

            <div class="mt-6 flex justify-between">
              <button
                id="back-to-step1"
                class="bg-gray-200 hover:bg-gray-300 text-gray-800 font-medium py-2 px-6 rounded-md transition-all"
              >
                Back
              </button>
              <button
                id="next-to-step3"
                class="bg-blue-600 hover:bg-blue-700 text-white font-medium py-2 px-6 rounded-md transition-all"
              >
                Next
              </button>
            </div>
          </div>

          <!-- Step 3: Doctor Selection -->
          <div id="step3" class="form-section">
            <div class="bg-white rounded-lg shadow-md p-6 mb-6">
              <h2 class="text-xl font-semibold mb-4 text-gray-800">
                Select a Doctor
              </h2>
              <div class="mb-4">
                <label
                  for="specialtyFilter"
                  class="block text-sm font-medium text-gray-700 mb-1"
                  >Filter by Specialty</label
                >
                <select
                  id="specialtyFilter"
                  class="w-full md:w-1/3 px-4 py-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500"
                >
                  <option value="all">All Specialties</option>
                  <option value="cardiology">Cardiology</option>
                  <option value="dermatology">Dermatology</option>
                  <option value="neurology">Neurology</option>
                  <option value="orthopedics">Orthopedics</option>
                  <option value="pediatrics">Pediatrics</option>
                  <option value="general">General Medicine</option>
                </select>
              </div>

              <div
                id="doctors-container"
                class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6"
              >
                <!-- Doctor cards will be dynamically populated here -->
              </div>
            </div>

            <div
              id="appointment-section"
              class="bg-white rounded-lg shadow-md p-6 hidden"
            >
              <h2 class="text-xl font-semibold mb-4 text-gray-800">
                Book an Appointment
              </h2>
              <div class="flex items-start space-x-4 mb-6">
                <div
                  id="selected-doctor-img"
                  class="w-20 h-20 rounded-full overflow-hidden"
                ></div>
                <div>
                  <h3
                    id="selected-doctor-name"
                    class="font-medium text-lg"
                  ></h3>
                  <p id="selected-doctor-specialty" class="text-gray-600"></p>
                </div>
              </div>

              <div class="mb-6">
                <label
                  for="appointmentDate"
                  class="block text-sm font-medium text-gray-700 mb-1"
                  >Select Date</label
                >
                <input
                  type="date"
                  id="appointmentDate"
                  class="w-full md:w-1/3 px-4 py-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500"
                  required
                />
              </div>

              <div>
                <p class="block text-sm font-medium text-gray-700 mb-2">
                  Available Time Slots
                </p>
                <div
                  id="time-slots"
                  class="grid grid-cols-3 md:grid-cols-6 gap-2"
                >
                  <!-- Time slots will be dynamically populated here -->
                </div>
              </div>
            </div>

            <div class="mt-6 flex justify-between">
              <button
                id="back-to-step2"
                class="bg-gray-200 hover:bg-gray-300 text-gray-800 font-medium py-2 px-6 rounded-md transition-all"
              >
                Back
              </button>
              <button
                id="next-to-step4"
                class="bg-blue-600 hover:bg-blue-700 text-white font-medium py-2 px-6 rounded-md transition-all"
                disabled
              >
                Book Appointment
              </button>
            </div>
          </div>

          <!-- Step 4: Confirmation -->
          <div id="step4" class="form-section">
            <div class="bg-white rounded-lg shadow-md p-6 mb-6">
              <div class="flex justify-center mb-6">
                <div class="rounded-full bg-green-100 p-3">
                  <svg
                    xmlns="http://www.w3.org/2000/svg"
                    class="h-12 w-12 text-green-600"
                    fill="none"
                    viewBox="0 0 24 24"
                    stroke="currentColor"
                  >
                    <path
                      stroke-linecap="round"
                      stroke-linejoin="round"
                      stroke-width="2"
                      d="M5 13l4 4L19 7"
                    />
                  </svg>
                </div>
              </div>
              <h2 class="text-2xl font-semibold mb-2 text-center text-gray-800">
                Appointment Confirmed!
              </h2>
              <p class="text-center text-gray-600 mb-6">
                Your appointment has been successfully booked.
              </p>

              <div
                class="bg-blue-50 border border-blue-200 rounded-lg p-4 mb-6"
              >
                <h3 class="font-medium text-blue-800 mb-2">
                  Appointment Details
                </h3>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                  <div>
                    <p class="text-sm text-gray-600">Patient Name</p>
                    <p id="confirm-name" class="font-medium"></p>
                  </div>
                  <div>
                    <p class="text-sm text-gray-600">Doctor</p>
                    <p id="confirm-doctor" class="font-medium"></p>
                  </div>
                  <div>
                    <p class="text-sm text-gray-600">Date</p>
                    <p id="confirm-date" class="font-medium"></p>
                  </div>
                  <div>
                    <p class="text-sm text-gray-600">Time</p>
                    <p id="confirm-time" class="font-medium"></p>
                  </div>
                </div>
              </div>

              <div class="bg-green-50 border border-green-200 rounded-lg p-4">
                <div class="flex items-start">
                  <svg
                    xmlns="http://www.w3.org/2000/svg"
                    class="h-5 w-5 text-green-600 mt-0.5 mr-2"
                    fill="none"
                    viewBox="0 0 24 24"
                    stroke="currentColor"
                  >
                    <path
                      stroke-linecap="round"
                      stroke-linejoin="round"
                      stroke-width="2"
                      d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"
                    />
                  </svg>
                  <div>
                    <p class="text-green-800 font-medium">What happens next?</p>
                    <p class="text-sm text-green-700 mt-1">
                      A confirmation has been sent to your WhatsApp number.
                      Please arrive 15 minutes before your appointment time. If
                      you need to reschedule, please call our helpline at least
                      24 hours in advance.
                    </p>
                  </div>
                </div>
              </div>
            </div>

            <div class="flex justify-center">
              <button
                id="new-appointment"
                class="bg-blue-600 hover:bg-blue-700 text-white font-medium py-2 px-6 rounded-md transition-all"
              >
                Book Another Appointment
              </button>
            </div>
          </div>
        </div>
      </div>

      <!-- WhatsApp Notification Modal -->
      <div
        id="whatsapp-modal"
        class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 hidden"
      >
        <div class="bg-white rounded-lg shadow-xl p-6 w-full max-w-md">
          <div class="flex justify-between items-center mb-4">
            <div class="flex items-center">
              <svg
                xmlns="http://www.w3.org/2000/svg"
                class="h-6 w-6 text-green-600 mr-2"
                fill="currentColor"
                viewBox="0 0 24 24"
              >
                <path
                  d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893a11.821 11.821 0 00-3.48-8.413z"
                />
              </svg>
              <h3 class="text-lg font-semibold text-gray-800">
                WhatsApp Notification
              </h3>
            </div>
            <button
              id="close-whatsapp-modal"
              class="text-gray-400 hover:text-gray-600"
            >
              <svg
                xmlns="http://www.w3.org/2000/svg"
                class="h-6 w-6"
                fill="none"
                viewBox="0 0 24 24"
                stroke="currentColor"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M6 18L18 6M6 6l12 12"
                />
              </svg>
            </button>
          </div>
          <div class="bg-gray-100 rounded-lg p-4 mb-4">
            <div class="flex items-center mb-2">
              <div
                class="w-8 h-8 bg-green-500 rounded-full flex items-center justify-center text-white font-bold"
              >
                M
              </div>
              <p class="ml-2 text-sm font-medium">MediCare Hospital</p>
            </div>
            <div class="bg-white rounded-lg p-3 mb-2 ml-auto mr-0 max-w-xs">
              <p class="text-sm" id="whatsapp-message"></p>
              <p
                class="text-xs text-gray-500 text-right mt-1"
                id="whatsapp-time"
              ></p>
            </div>
          </div>
          <p class="text-center text-sm text-gray-600">
            Notification sent successfully!
          </p>
        </div>
      </div>
    </div>

    <script>
      // Function to create doctor SVG avatar
      function createDoctorSVG(color, gender) {
        const hairStyle =
          gender === "female"
            ? `<path d="M32 16c0-8.837-7.163-16-16-16S0 7.163 0 16c0 6.03 3.182 11.135 7.68 13.83C9.87 35.307 15.576 38 22 38c8.284 0 15-6.716 15-15 0-3.02-.894-5.83-2.43-8.185C35.484 13.344 36 14.614 36 16c0 8.837-7.163 16-16 16S4 24.837 4 16 11.163 0 20 0c7.195 0 13.308 4.738 15.312 11.274C33.142 7.197 29.199 4 24.5 4c-6.351 0-11.5 5.149-11.5 11.5 0 2.52.81 4.85 2.184 6.738C18.141 23.322 21.085 24 24.5 24c6.351 0 11.5-5.149 11.5-11.5 0-.174-.004-.346-.012-.517C36.634 13.939 37 14.932 37 16c0 9.389-7.611 17-17 17S3 25.389 3 16 10.611-1 20-1c8.774 0 16.01 6.631 16.917 15.153C36.972 13.715 37 13.344 37 12.962 37 5.807 31.193 0 24.038 0c-5.077 0-9.438 2.931-11.558 7.18C14.398 6.142 17.264 5 20.5 5c6.351 0 11.5 5.149 11.5 11.5S26.851 28 20.5 28c-2.074 0-4.017-.55-5.698-1.511C16.595 28.041 18.737 29 21.076 29c5.76 0 10.424-4.674 10.424-10.435 0-2.926-1.195-5.567-3.125-7.467C30.533 9.25 33 10.336 33 12c0 1.657-1.343 3-3 3s-3-1.343-3-3c0-1.657 1.343-3 3-3 .159 0 .314.013.467.035C27.532 5.405 23.75 3 19.5 3 13.149 3 8 8.149 8 14.5S13.149 26 19.5 26c4.086 0 7.662-2.25 9.5-5.573" fill="${color}"/>`
            : `<path d="M18 2.5c-6.63 0-12 5.37-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C10.4 20.07 9.76 19.66 9.76 19.66c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C26.565 24.295 30 19.795 30 14.5c0-6.63-5.37-12-12-12" fill="${color}"/>`;

        return `<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 50 50" width="100" height="100">
                <circle cx="25" cy="25" r="20" fill="#f3f4f6"/>
                <g transform="translate(12, 10)">
                    ${hairStyle}
                </g>
            </svg>`;
      }

      // Initialize sample data
      const doctors = [
        {
          id: 1,
          name: "Dr. Sarah Johnson",
          specialty: "cardiology",
          specialtyName: "Cardiology",
          experience: 12,
          image: createDoctorSVG("#3b82f6", "female"),
          availability: ["Monday", "Tuesday", "Thursday", "Friday"],
          timeSlots: [
            "09:00 AM",
            "10:00 AM",
            "11:00 AM",
            "02:00 PM",
            "03:00 PM",
            "04:00 PM",
          ],
          active: true,
        },
        {
          id: 2,
          name: "Dr. Michael Chen",
          specialty: "dermatology",
          specialtyName: "Dermatology",
          experience: 8,
          image: createDoctorSVG("#10b981", "male"),
          availability: ["Monday", "Wednesday", "Friday"],
          timeSlots: [
            "09:30 AM",
            "10:30 AM",
            "11:30 AM",
            "02:30 PM",
            "03:30 PM",
          ],
          active: true,
        },
        {
          id: 3,
          name: "Dr. Robert Williams",
          specialty: "neurology",
          specialtyName: "Neurology",
          experience: 15,
          image: createDoctorSVG("#6366f1", "male"),
          availability: ["Tuesday", "Thursday", "Saturday"],
          timeSlots: [
            "08:00 AM",
            "09:00 AM",
            "10:00 AM",
            "01:00 PM",
            "02:00 PM",
          ],
          active: true,
        },
        {
          id: 4,
          name: "Dr. Emily Rodriguez",
          specialty: "orthopedics",
          specialtyName: "Orthopedics",
          experience: 10,
          image: createDoctorSVG("#ec4899", "female"),
          availability: ["Monday", "Wednesday", "Friday", "Saturday"],
          timeSlots: [
            "10:00 AM",
            "11:00 AM",
            "12:00 PM",
            "03:00 PM",
            "04:00 PM",
          ],
          active: true,
        },
        {
          id: 5,
          name: "Dr. James Wilson",
          specialty: "pediatrics",
          specialtyName: "Pediatrics",
          experience: 7,
          image: createDoctorSVG("#f59e0b", "male"),
          availability: ["Tuesday", "Wednesday", "Thursday", "Saturday"],
          timeSlots: [
            "09:00 AM",
            "10:00 AM",
            "11:00 AM",
            "02:00 PM",
            "03:00 PM",
          ],
          active: true,
        },
        {
          id: 6,
          name: "Dr. Lisa Thompson",
          specialty: "general",
          specialtyName: "General Medicine",
          experience: 9,
          image: createDoctorSVG("#8b5cf6", "female"),
          availability: ["Monday", "Tuesday", "Thursday", "Friday"],
          timeSlots: [
            "08:30 AM",
            "09:30 AM",
            "10:30 AM",
            "01:30 PM",
            "02:30 PM",
            "03:30 PM",
          ],
          active: true,
        },
      ];

      const appointments = [
        {
          id: 1,
          patientName: "John Smith",
          patientAge: 45,
          patientGender: "Male",
          patientPhone: "555-123-4567",
          doctorId: 1,
          date: "2023-06-15",
          time: "10:00 AM",
          status: "Confirmed",
          condition: "Chest pain and shortness of breath",
        },
        {
          id: 2,
          patientName: "Emma Davis",
          patientAge: 32,
          patientGender: "Female",
          patientPhone: "555-987-6543",
          doctorId: 4,
          date: "2023-06-15",
          time: "11:00 AM",
          status: "Confirmed",
          condition: "Persistent knee pain after injury",
        },
        {
          id: 3,
          patientName: "David Wilson",
          patientAge: 8,
          patientGender: "Male",
          patientPhone: "555-456-7890",
          doctorId: 5,
          date: getCurrentDate(),
          time: "09:00 AM",
          status: "Pending",
          condition: "Fever and sore throat",
        },
      ];

      // Initialize data in localStorage if not already present
      if (!localStorage.getItem("hms_doctors")) {
        localStorage.setItem("hms_doctors", JSON.stringify(doctors));
      }

      if (!localStorage.getItem("hms_appointments")) {
        localStorage.setItem("hms_appointments", JSON.stringify(appointments));
      }

      // Global variables
      let currentStep = 1;
      let selectedDoctor = null;
      let selectedTime = null;
      let selectedDate = null;
      let patientData = {};

      // DOM Elements
      const patientPortal = document.getElementById("patient-portal");
      const patientPortalBtn = document.getElementById("patient-portal-btn");
      const progressBar = document.getElementById("progress-bar");
      const painLevel = document.getElementById("painLevel");
      const painLevelValue = document.getElementById("painLevelValue");
      const specialtyFilter = document.getElementById("specialtyFilter");
      const doctorsContainer = document.getElementById("doctors-container");
      const appointmentSection = document.getElementById("appointment-section");
      const timeSlots = document.getElementById("time-slots");
      const bookAppointmentBtn = document.getElementById("next-to-step4");
      const whatsappModal = document.getElementById("whatsapp-modal");
      const closeWhatsappModal = document.getElementById(
        "close-whatsapp-modal"
      );
      const whatsappMessage = document.getElementById("whatsapp-message");
      const whatsappTime = document.getElementById("whatsapp-time");

      // Initialize the application
      document.addEventListener("DOMContentLoaded", function () {
        initPatientForm();
        initEventListeners();
      });

      // Initialize Patient Form
      function initPatientForm() {
        // Get updated doctors list from localStorage
        const storedDoctors = JSON.parse(localStorage.getItem("hms_doctors"));
        displayDoctors(storedDoctors);

        // Pain level slider
        painLevel.addEventListener("input", function () {
          painLevelValue.textContent = this.value;
        });

        // Specialty filter
        specialtyFilter.addEventListener("change", function () {
          const storedDoctors = JSON.parse(localStorage.getItem("hms_doctors"));
          displayDoctors(storedDoctors, this.value);
        });
      }

      // Initialize Event Listeners
      function initEventListeners() {
        // Portal navigation
        patientPortalBtn.addEventListener("click", function () {
          patientPortal.classList.remove("hidden");
          patientPortalBtn.classList.add("bg-blue-700");
        });

        // Patient form navigation
        document
          .getElementById("next-to-step2")
          .addEventListener("click", function () {
            if (validateStep1()) {
              goToStep(2);
            }
          });

        document
          .getElementById("back-to-step1")
          .addEventListener("click", function () {
            goToStep(1);
          });

        document
          .getElementById("next-to-step3")
          .addEventListener("click", function () {
            if (validateStep2()) {
              goToStep(3);
            }
          });

        document
          .getElementById("back-to-step2")
          .addEventListener("click", function () {
            goToStep(2);
          });

        document
          .getElementById("next-to-step4")
          .addEventListener("click", function () {
            if (validateStep3()) {
              // Save patient data
              patientData = {
                name: document.getElementById("fullName").value,
                age: document.getElementById("age").value,
                gender: document.getElementById("gender").value,
                phone: document.getElementById("phone").value,
                email: document.getElementById("email").value,
                condition: document.getElementById("currentCondition").value,
                doctorId: selectedDoctor.id,
                date: selectedDate,
                time: selectedTime,
              };

              // Update confirmation page
              document.getElementById("confirm-name").textContent =
                patientData.name;
              document.getElementById("confirm-doctor").textContent =
                selectedDoctor.name;
              document.getElementById("confirm-date").textContent = formatDate(
                patientData.date
              );
              document.getElementById("confirm-time").textContent =
                patientData.time;

              // Add appointment to the system
              const storedAppointments =
                JSON.parse(localStorage.getItem("hms_appointments")) || [];
              const newAppointment = {
                id:
                  storedAppointments.length > 0
                    ? Math.max(...storedAppointments.map((a) => a.id)) + 1
                    : 1,
                patientName: patientData.name,
                patientAge: patientData.age,
                patientGender: patientData.gender,
                patientPhone: patientData.phone,
                doctorId: patientData.doctorId,
                date: patientData.date,
                time: patientData.time,
                status: "Confirmed",
                condition: patientData.condition,
              };
              storedAppointments.push(newAppointment);
              localStorage.setItem(
                "hms_appointments",
                JSON.stringify(storedAppointments)
              );

              // Show WhatsApp notification
              showWhatsAppNotification(patientData, selectedDoctor);

              goToStep(4);
            }
          });

        document
          .getElementById("new-appointment")
          .addEventListener("click", function () {
            resetForm();
            goToStep(1);
          });

        // WhatsApp modal
        closeWhatsappModal.addEventListener("click", function () {
          whatsappModal.classList.add("hidden");
        });
      }

      // Display doctors based on filter
      function displayDoctors(doctorsList = doctors, specialty = "all") {
        doctorsContainer.innerHTML = "";

        const filteredDoctors =
          specialty === "all"
            ? doctorsList.filter((d) => d.active !== false)
            : doctorsList.filter(
                (d) => d.specialty === specialty && d.active !== false
              );

        filteredDoctors.forEach((doctor) => {
          const doctorCard = document.createElement("div");
          doctorCard.className =
            "doctor-card bg-white rounded-lg shadow-md p-4 border border-gray-200 transition-all duration-300";
          doctorCard.innerHTML = `
                    <div class="flex flex-col items-center mb-4">
                        <div class="w-24 h-24 mb-2">${doctor.image}</div>
                        <h3 class="font-medium text-lg text-center">${
                          doctor.name
                        }</h3>
                        <p class="text-blue-600 font-medium">${
                          doctor.specialtyName
                        }</p>
                    </div>
                    <div class="border-t border-gray-200 pt-3">
                        <div class="flex justify-between mb-2">
                            <span class="text-gray-600 text-sm">Experience</span>
                            <span class="font-medium text-sm">${
                              doctor.experience
                            } years</span>
                        </div>
                        <div class="mb-3">
                            <span class="text-gray-600 text-sm">Available on</span>
                            <div class="flex flex-wrap mt-1">
                                ${doctor.availability
                                  .map(
                                    (day) => `
                                    <span class="bg-blue-100 text-blue-800 text-xs px-2 py-1 rounded mr-1 mb-1">${day}</span>
                                `
                                  )
                                  .join("")}
                            </div>
                        </div>
                        <button class="select-doctor-btn w-full bg-blue-600 hover:bg-blue-700 text-white font-medium py-2 px-4 rounded-md transition-all" data-id="${
                          doctor.id
                        }">
                            Select Doctor
                        </button>
                    </div>
                `;
          doctorsContainer.appendChild(doctorCard);

          // Add event listener to the button
          doctorCard
            .querySelector(".select-doctor-btn")
            .addEventListener("click", function () {
              const doctorId = parseInt(this.getAttribute("data-id"));
              const storedDoctors =
                JSON.parse(localStorage.getItem("hms_doctors")) || doctors;
              selectDoctor(doctorId, storedDoctors);
            });
        });
      }

      // Select a doctor
      function selectDoctor(doctorId, doctorsList = doctors) {
        selectedDoctor = doctorsList.find((doctor) => doctor.id === doctorId);
        if (!selectedDoctor) return;

        // Update appointment section
        document.getElementById("selected-doctor-img").innerHTML =
          selectedDoctor.image;
        document.getElementById("selected-doctor-name").textContent =
          selectedDoctor.name;
        document.getElementById("selected-doctor-specialty").textContent =
          selectedDoctor.specialtyName;

        // Show appointment section
        appointmentSection.classList.remove("hidden");

        // Set min date to today
        const appointmentDateInput = document.getElementById("appointmentDate");
        appointmentDateInput.min = getCurrentDate();
        appointmentDateInput.value = getCurrentDate();

        // Ensure timeSlots is always an array
        selectedDoctor.timeSlots = Array.isArray(selectedDoctor.timeSlots)
          ? selectedDoctor.timeSlots
          : [
              "09:00 AM",
              "10:00 AM",
              "11:00 AM",
              "02:00 PM",
              "03:00 PM",
              "04:00 PM",
            ];

        // Update time slots
        updateTimeSlots(getCurrentDate());

        // Add event listener to date input
        appointmentDateInput.addEventListener("change", function () {
          updateTimeSlots(this.value);
        });

        // Scroll to appointment section
        appointmentSection.scrollIntoView({ behavior: "smooth" });
      }

      // Update time slots based on selected date
      function updateTimeSlots(date) {
        selectedDate = date;
        timeSlots.innerHTML = "";

        // Get day of week
        const dayOfWeek = new Date(date).toLocaleDateString("en-US", {
          weekday: "long",
        });

        // Check if doctor is available on this day
        if (!selectedDoctor.availability.includes(dayOfWeek)) {
          timeSlots.innerHTML = `
                    <div class="col-span-full text-center py-4">
                        <p class="text-gray-600">Doctor is not available on ${dayOfWeek}.</p>
                        <p class="text-gray-600">Please select another date.</p>
                    </div>
                `;
          bookAppointmentBtn.disabled = true;
          return;
        }

        // Get stored appointments
        const storedAppointments =
          JSON.parse(localStorage.getItem("hms_appointments")) || [];

        // Convert time slots to 24-hour format for comparison
        const timeSlots24 = {
          "08:30 AM": "08:30",
          "09:00 AM": "09:00",
          "09:30 AM": "09:30",
          "10:00 AM": "10:00",
          "10:30 AM": "10:30",
          "11:00 AM": "11:00",
          "11:30 AM": "11:30",
          "12:00 PM": "12:00",
          "01:00 PM": "13:00",
          "01:30 PM": "13:30",
          "02:00 PM": "14:00",
          "02:30 PM": "14:30",
          "03:00 PM": "15:00",
          "03:30 PM": "15:30",
          "04:00 PM": "16:00",
        };

        const currentDate = getCurrentDate();
        const currentTime = getCurrentTimeIn24Hour();

        // Generate time slots
        selectedDoctor.timeSlots.forEach((time) => {
          const time24 = timeSlots24[time] || time.replace(/\s[AP]M$/, "");
          const isBooked = storedAppointments.some(
            (appointment) =>
              appointment.doctorId === selectedDoctor.id &&
              appointment.date === date &&
              appointment.time === time
          );
          const isDisabled =
            date === currentDate && compareTime(time24, currentTime) <= 0;

          const slot = document.createElement("div");
          slot.className = `time-slot text-center p-2 border rounded-md cursor-pointer ${
            isBooked ? "booked" : ""
          } ${isDisabled ? "disabled" : ""}`;
          slot.textContent = time;

          if (!isBooked && !isDisabled) {
            slot.addEventListener("click", function () {
              // Remove selected class from all slots
              document
                .querySelectorAll(".time-slot")
                .forEach((s) => s.classList.remove("selected"));
              // Add selected class to this slot
              this.classList.add("selected");
              // Update selected time
              selectedTime = time;
              // Enable book appointment button
              bookAppointmentBtn.disabled = false;
            });
          }

          timeSlots.appendChild(slot);
        });
      }

      // Show WhatsApp notification for new booking
      function showWhatsAppNotification(patientData, doctor) {
        const message = `Dear ${patientData.name},\nYour appointment with ${
          doctor.name
        } on ${formatDate(patientData.date)} at ${
          patientData.time
        } is confirmed. Please arrive 15 minutes early. Contact: ${
          patientData.phone
        }`;
        whatsappMessage.textContent = message;
        whatsappTime.textContent = getCurrentTime();
        whatsappModal.classList.remove("hidden");
        setTimeout(() => whatsappModal.classList.add("hidden"), 5000);
      }

      // Reset patient form
      function resetForm() {
        currentStep = 1;
        selectedDoctor = null;
        selectedTime = null;
        selectedDate = null;
        patientData = {};
        document
          .querySelectorAll(".form-section")
          .forEach((section) => section.classList.remove("active"));
        document.getElementById(`step${currentStep}`).classList.add("active");
        updateProgressBar();
        appointmentSection.classList.add("hidden");
        document.getElementById("fullName").value = "";
        document.getElementById("age").value = "";
        document.getElementById("gender").value = "";
        document.getElementById("phone").value = "";
        document.getElementById("email").value = "";
        document.getElementById("address").value = "";
        document.getElementById("height").value = "";
        document.getElementById("weight").value = "";
        document.getElementById("bloodGroup").value = "";
        document
          .querySelectorAll('input[type="checkbox"]')
          .forEach((checkbox) => (checkbox.checked = false));
        document.getElementById("allergies").value = "";
        document.getElementById("medications").value = "";
        document.getElementById("currentCondition").value = "";
        document.getElementById("painLevel").value = 0;
        document.getElementById("painLevelValue").textContent = "0";
        bookAppointmentBtn.disabled = true;
        timeSlots.innerHTML = "";
        document
          .querySelectorAll(".step-label")
          .forEach((label) => label.classList.remove("text-blue-600"));
        document
          .getElementById(`step${currentStep}-label`)
          .classList.add("text-blue-600");
      }

      // Validate form steps
      function validateStep1() {
        const requiredFields = [
          "fullName",
          "age",
          "gender",
          "phone",
          "email",
          "address",
          "height",
          "weight",
          "bloodGroup",
        ];
        return requiredFields.every(
          (field) => document.getElementById(field).value.trim() !== ""
        );
      }

      function validateStep2() {
        return document.getElementById("currentCondition").value.trim() !== "";
      }

      function validateStep3() {
        return selectedDoctor && selectedDate && selectedTime;
      }

      // Go to specific step
      function goToStep(step) {
        currentStep = step;
        document
          .querySelectorAll(".form-section")
          .forEach((section) => section.classList.remove("active"));
        document.getElementById(`step${step}`).classList.add("active");
        updateProgressBar();
        document
          .querySelectorAll(".step-label")
          .forEach((label) => label.classList.remove("text-blue-600"));
        document
          .getElementById(`step${step}-label`)
          .classList.add("text-blue-600");
      }

      // Update progress bar
      function updateProgressBar() {
        const progress = (currentStep / 4) * 100;
        progressBar.style.width = `${progress}%`;
      }

      // Utility functions
      function getCurrentDate() {
        const today = new Date();
        return today.toISOString().split("T")[0];
      }

      function getCurrentTime() {
        const now = new Date();
        return now.toLocaleTimeString("en-US", {
          hour: "2-digit",
          minute: "2-digit",
        });
      }

      function getCurrentTimeIn24Hour() {
        const now = new Date();
        return now.toLocaleTimeString("en-GB", {
          hour12: false,
          hour: "2-digit",
          minute: "2-digit",
        });
      }

      function formatDate(dateString) {
        const date = new Date(dateString);
        return date.toLocaleDateString("en-US", {
          weekday: "long",
          year: "numeric",
          month: "long",
          day: "numeric",
        });
      }

      function compareTime(time1, time2) {
        // Convert times to minutes since midnight for comparison
        const [h1, m1] = time1.split(":").map(Number);
        const [h2, m2] = time2.split(":").map(Number);
        return h1 * 60 + m1 - (h2 * 60 + m2);
      }

      function getRandomColor() {
        const colors = [
          "#3b82f6",
          "#10b981",
          "#6366f1",
          "#ec4899",
          "#f59e0b",
          "#8b5cf6",
        ];
        return colors[Math.floor(Math.random() * colors.length)];
      }
    </script>
  </body>
</html>
