<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Receptionist Portal - Hospital Management System</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link
      href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap"
      rel="stylesheet"
    />
    <style>
      body {
        font-family: "Poppins", sans-serif;
        background-color: #f0f4f8;
      }
      .doctor-item:hover {
        background-color: #f9fafb;
      }
    </style>
  </head>
  <body>
    <div class="min-h-screen">
      <!-- Main Navigation -->
      <div
        class="bg-gradient-to-r from-blue-600 to-blue-800 text-white p-4 shadow-md"
      >
        <div class="container mx-auto flex justify-between items-center">
          <div class="flex items-center space-x-2">
            <svg
              xmlns="http://www.w3.org/2000/svg"
              class="h-8 w-8"
              fill="none"
              viewBox="0 0 24 24"
              stroke="currentColor"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"
              />
            </svg>
            <h1 class="text-2xl font-bold">Yashoda Hospital</h1>
          </div>
          <div class="flex space-x-4">
            <button
              id="receptionist-portal-btn"
              class="px-4 py-2 rounded-lg font-medium transition-all bg-blue-700"
            >
              Receptionist Portal
            </button>
          </div>
        </div>
      </div>

      <!-- Receptionist Portal -->
      <div id="receptionist-portal" class="container mx-auto py-8 px-4">
        <div class="bg-white rounded-lg shadow-md p-6 mb-6">
          <h2 class="text-xl font-semibold mb-4 text-gray-800">
            Receptionist Dashboard
          </h2>
          <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-6">
            <div class="bg-blue-50 border border-blue-200 rounded-lg p-4">
              <h3 class="font-medium text-blue-800 mb-1">
                Today's Appointments
              </h3>
              <p
                class="text-3xl font-bold text-blue-600"
                id="today-appointments-count"
              >
                0
              </p>
            </div>
            <div class="bg-green-50 border border-green-200 rounded-lg p-4">
              <h3 class="font-medium text-green-800 mb-1">Available Doctors</h3>
              <p
                class="text-3xl font-bold text-green-600"
                id="available-doctors-count"
              >
                0
              </p>
            </div>
            <div class="bg-purple-50 border border-purple-200 rounded-lg p-4">
              <h3 class="font-medium text-purple-800 mb-1">Total Patients</h3>
              <p
                class="text-3xl font-bold text-purple-600"
                id="total-patients-count"
              >
                0
              </p>
            </div>
          </div>

          <div
            class="flex flex-col md:flex-row space-y-4 md:space-y-0 md:space-x-4"
          >
            <div class="w-full md:w-2/3">
              <div class="bg-gray-50 border border-gray-200 rounded-lg p-4">
                <div
                  class="flex flex-col md:flex-row justify-between items-start md:items-center mb-4 space-y-2 md:space-y-0"
                >
                  <h3 class="font-medium text-gray-800">
                    Upcoming Appointments
                  </h3>
                  <div class="flex space-x-2">
                    <input
                      type="date"
                      id="filter-date"
                      class="px-3 py-1 border border-gray-300 rounded-md text-sm focus:ring-blue-500 focus:border-blue-500"
                    />
                    <button
                      id="filter-appointments"
                      class="bg-blue-600 hover:bg-blue-700 text-white text-sm py-1 px-3 rounded-md transition-all"
                    >
                      Filter
                    </button>
                  </div>
                </div>
                <div class="overflow-x-auto">
                  <table class="min-w-full divide-y divide-gray-200">
                    <thead class="bg-gray-100">
                      <tr>
                        <th
                          class="px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"
                        >
                          Patient
                        </th>
                        <th
                          class="px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"
                        >
                          Doctor
                        </th>
                        <th
                          class="px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"
                        >
                          Date
                        </th>
                        <th
                          class="px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"
                        >
                          Time
                        </th>
                        <th
                          class="px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"
                        >
                          Status
                        </th>
                        <th
                          class="px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"
                        >
                          Actions
                        </th>
                      </tr>
                    </thead>
                    <tbody
                      id="appointments-table"
                      class="bg-white divide-y divide-gray-200"
                    >
                      <!-- Appointments will be dynamically populated here -->
                    </tbody>
                  </table>
                </div>
              </div>
            </div>

            <div class="w-full md:w-1/3">
              <div class="bg-gray-50 border border-gray-200 rounded-lg p-4">
                <h3 class="font-medium text-gray-800 mb-4">
                  Doctor Management
                </h3>
                <div class="mb-4">
                  <button
                    id="add-doctor-btn"
                    class="w-full bg-green-600 hover:bg-green-700 text-white font-medium py-2 px-4 rounded-md transition-all flex items-center justify-center"
                  >
                    <svg
                      xmlns="http://www.w3.org/2000/svg"
                      class="h-5 w-5 mr-2"
                      fill="none"
                      viewBox="0 0 24 24"
                      stroke="currentColor"
                    >
                      <path
                        stroke-linecap="round"
                        stroke-linejoin="round"
                        stroke-width="2"
                        d="M12 6v6m0 0v6m0-6h6m-6 0H6"
                      />
                    </svg>
                    Add New Doctor
                  </button>
                </div>
                <div id="doctors-list" class="space-y-3">
                  <!-- Doctors will be dynamically populated here -->
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Add/Edit Doctor Modal -->
      <div
        id="add-doctor-modal"
        class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 hidden"
      >
        <div class="bg-white rounded-lg shadow-xl p-6 w-full max-w-md">
          <div class="flex justify-between items-center mb-4">
            <h3
              class="text-lg font-semibold text-gray-800"
              id="doctor-modal-title"
            >
              Add New Doctor
            </h3>
            <button id="close-modal" class="text-gray-400 hover:text-gray-600">
              <svg
                xmlns="http://www.w3.org/2000/svg"
                class="h-6 w-6"
                fill="none"
                viewBox="0 0 24 24"
                stroke="currentColor"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M6 18L18 6M6 6l12 12"
                />
              </svg>
            </button>
          </div>
          <form id="add-doctor-form">
            <input type="hidden" id="doctor-id" />
            <div class="mb-4">
              <label
                for="doctor-name"
                class="block text-sm font-medium text-gray-700 mb-1"
                >Full Name</label
              >
              <input
                type="text"
                id="doctor-name"
                class="w-full px-4 py-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500"
                required
              />
            </div>
            <div class="mb-4">
              <label
                for="doctor-specialty"
                class="block text-sm font-medium text-gray-700 mb-1"
                >Specialty</label
              >
              <select
                id="doctor-specialty"
                class="w-full px-4 py-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500"
                required
              >
                <option value="" disabled>Select specialty</option>
                <option value="cardiology">Cardiology</option>
                <option value="dermatology">Dermatology</option>
                <option value="neurology">Neurology</option>
                <option value="orthopedics">Orthopedics</option>
                <option value="pediatrics">Pediatrics</option>
                <option value="general">General Medicine</option>
              </select>
            </div>
            <div class="mb-4">
              <label
                for="doctor-experience"
                class="block text-sm font-medium text-gray-700 mb-1"
                >Experience (years)</label
              >
              <input
                type="number"
                id="doctor-experience"
                class="w-full px-4 py-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500"
                required
              />
            </div>
            <div class="mb-4">
              <label class="block text-sm font-medium text-gray-700 mb-1"
                >Availability</label
              >
              <div class="grid grid-cols-2 gap-2">
                <div class="flex items-center">
                  <input
                    type="checkbox"
                    id="avail-monday"
                    class="w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500"
                  />
                  <label for="avail-monday" class="ml-2 text-sm text-gray-700"
                    >Monday</label
                  >
                </div>
                <div class="flex items-center">
                  <input
                    type="checkbox"
                    id="avail-tuesday"
                    class="w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500"
                  />
                  <label for="avail-tuesday" class="ml-2 text-sm text-gray-700"
                    >Tuesday</label
                  >
                </div>
                <div class="flex items-center">
                  <input
                    type="checkbox"
                    id="avail-wednesday"
                    class="w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500"
                  />
                  <label
                    for="avail-wednesday"
                    class="ml-2 text-sm text-gray-700"
                    >Wednesday</label
                  >
                </div>
                <div class="flex items-center">
                  <input
                    type="checkbox"
                    id="avail-thursday"
                    class="w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500"
                  />
                  <label for="avail-thursday" class="ml-2 text-sm text-gray-700"
                    >Thursday</label
                  >
                </div>
                <div class="flex items-center">
                  <input
                    type="checkbox"
                    id="avail-friday"
                    class="w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500"
                  />
                  <label for="avail-friday" class="ml-2 text-sm text-gray-700"
                    >Friday</label
                  >
                </div>
                <div class="flex items-center">
                  <input
                    type="checkbox"
                    id="avail-saturday"
                    class="w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500"
                  />
                  <label for="avail-saturday" class="ml-2 text-sm text-gray-700"
                    >Saturday</label
                  >
                </div>
              </div>
            </div>
            <div class="flex justify-end">
              <button
                type="button"
                id="cancel-add-doctor"
                class="bg-gray-200 hover:bg-gray-300 text-gray-800 font-medium py-2 px-4 rounded-md transition-all mr-2"
              >
                Cancel
              </button>
              <button
                type="submit"
                id="submit-doctor-btn"
                class="bg-blue-600 hover:bg-blue-700 text-white font-medium py-2 px-4 rounded-md transition-all"
              >
                Save
              </button>
            </div>
          </form>
        </div>
      </div>

      <!-- Appointment Details Modal -->
      <div
        id="appointment-details-modal"
        class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 hidden"
      >
        <div class="bg-white rounded-lg shadow-xl p-6 w-full max-w-lg">
          <div class="flex justify-between items-center mb-4">
            <h3 class="text-lg font-semibold text-gray-800">
              Appointment Details
            </h3>
            <button
              id="close-appointment-modal"
              class="text-gray-400 hover:text-gray-600"
            >
              <svg
                xmlns="http://www.w3.org/2000/svg"
                class="h-6 w-6"
                fill="none"
                viewBox="0 0 24 24"
                stroke="currentColor"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M6 18L18 6M6 6l12 12"
                />
              </svg>
            </button>
          </div>
          <div id="appointment-details-content" class="space-y-4">
            <!-- Appointment details will be populated here -->
          </div>
          <div class="flex justify-end mt-6 space-x-2">
            <button
              id="send-notification-btn"
              class="bg-green-600 hover:bg-green-700 text-white font-medium py-2 px-4 rounded-md transition-all"
            >
              Send Notification
            </button>
            <button
              id="update-status-btn"
              class="bg-blue-600 hover:bg-blue-700 text-white font-medium py-2 px-4 rounded-md transition-all"
            >
              Update Status
            </button>
            <button
              id="delete-appointment-btn"
              class="bg-red-600 hover:bg-red-700 text-white font-medium py-2 px-4 rounded-md transition-all"
            >
              Delete
            </button>
          </div>
        </div>
      </div>
    </div>

    <script>
      // DOM Elements
      const receptionistPortal = document.getElementById("receptionist-portal");
      const receptionistPortalBtn = document.getElementById(
        "receptionist-portal-btn"
      );
      const todayAppointmentsCount = document.getElementById(
        "today-appointments-count"
      );
      const availableDoctorsCount = document.getElementById(
        "available-doctors-count"
      );
      const totalPatientsCount = document.getElementById(
        "total-patients-count"
      );
      const filterDate = document.getElementById("filter-date");
      const filterAppointmentsBtn = document.getElementById(
        "filter-appointments"
      );
      const appointmentsTable = document.getElementById("appointments-table");
      const addDoctorBtn = document.getElementById("add-doctor-btn");
      const addDoctorModal = document.getElementById("add-doctor-modal");
      const closeModal = document.getElementById("close-modal");
      const addDoctorForm = document.getElementById("add-doctor-form");
      const cancelAddDoctor = document.getElementById("cancel-add-doctor");
      const doctorsList = document.getElementById("doctors-list");
      const appointmentDetailsModal = document.getElementById(
        "appointment-details-modal"
      );
      const closeAppointmentModal = document.getElementById(
        "close-appointment-modal"
      );
      const appointmentDetailsContent = document.getElementById(
        "appointment-details-content"
      );
      const submitDoctorBtn = document.getElementById("submit-doctor-btn");

      // Initialize the application
      document.addEventListener("DOMContentLoaded", function () {
        initReceptionistPortal();
      });

      // Initialize Receptionist Portal
      function initReceptionistPortal() {
        updateDashboard();
        displayAppointments();
        displayDoctorsList();
        initEventListeners();

        // Set default filter date to today
        filterDate.value = getCurrentDate();
      }

      // Initialize Event Listeners
      function initEventListeners() {
        receptionistPortalBtn.addEventListener("click", function () {
          receptionistPortal.classList.remove("hidden");
          receptionistPortalBtn.classList.add("bg-blue-700");
        });

        addDoctorBtn.addEventListener("click", function () {
          document.getElementById("doctor-modal-title").textContent =
            "Add New Doctor";
          submitDoctorBtn.textContent = "Add Doctor";
          document.getElementById("doctor-id").value = "";
          addDoctorForm.reset();
          addDoctorModal.classList.remove("hidden");
        });

        closeModal.addEventListener("click", function () {
          addDoctorModal.classList.add("hidden");
          addDoctorForm.reset();
          document.getElementById("doctor-id").value = "";
        });

        cancelAddDoctor.addEventListener("click", function () {
          addDoctorModal.classList.add("hidden");
          addDoctorForm.reset();
          document.getElementById("doctor-id").value = "";
        });

        addDoctorForm.addEventListener("submit", function (e) {
          e.preventDefault();
          const doctorId = document.getElementById("doctor-id").value;
          if (doctorId) {
            updateDoctor(doctorId);
          } else {
            addNewDoctor();
          }
        });

        filterAppointmentsBtn.addEventListener("click", function () {
          displayAppointments(filterDate.value);
        });

        closeAppointmentModal.addEventListener("click", function () {
          appointmentDetailsModal.classList.add("hidden");
        });
      }

      // Update dashboard counts
      function updateDashboard() {
        const storedAppointments =
          JSON.parse(localStorage.getItem("hms_appointments")) || [];
        const storedDoctors =
          JSON.parse(localStorage.getItem("hms_doctors")) || [];

        const today = getCurrentDate();
        todayAppointmentsCount.textContent = storedAppointments.filter(
          (a) => a.date === today && a.status !== "Cancelled"
        ).length;
        availableDoctorsCount.textContent = storedDoctors.filter(
          (d) => d.active !== false
        ).length;
        totalPatientsCount.textContent = new Set(
          storedAppointments.map((a) => a.patientName)
        ).size;
      }

      // Display appointments
      function displayAppointments(dateFilter = null) {
        const storedAppointments =
          JSON.parse(localStorage.getItem("hms_appointments")) || [];
        const storedDoctors =
          JSON.parse(localStorage.getItem("hms_doctors")) || [];
        appointmentsTable.innerHTML = "";

        const filteredAppointments = dateFilter
          ? storedAppointments.filter(
              (appointment) =>
                appointment.date === dateFilter &&
                appointment.status !== "Cancelled"
            )
          : storedAppointments.filter(
              (appointment) => appointment.status !== "Cancelled"
            );

        filteredAppointments.forEach((appointment) => {
          const doctor = storedDoctors.find(
            (d) => d.id === appointment.doctorId
          );
          const row = document.createElement("tr");
          row.innerHTML = `
                    <td class="px-4 py-2 text-sm text-gray-700">${
                      appointment.patientName
                    }</td>
                    <td class="px-4 py-2 text-sm text-gray-700">${
                      doctor ? doctor.name : "Unknown"
                    }</td>
                    <td class="px-4 py-2 text-sm text-gray-700">${formatDate(
                      appointment.date
                    )}</td>
                    <td class="px-4 py-2 text-sm text-gray-700">${
                      appointment.time
                    }</td>
                    <td class="px-4 py-2 text-sm">
                        <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${
                          appointment.status === "Confirmed"
                            ? "bg-green-100 text-green-800"
                            : appointment.status === "Pending"
                            ? "bg-yellow-100 text-yellow-800"
                            : "bg-red-100 text-red-800"
                        }">
                            ${appointment.status}
                        </span>
                    </td>
                    <td class="px-4 py-2 text-sm">
                        <button class="view-appointment-btn text-blue-600 hover:text-blue-800" data-id="${
                          appointment.id
                        }">
                            View
                        </button>
                    </td>
                `;
          appointmentsTable.appendChild(row);

          // Add event listener to view button
          row
            .querySelector(".view-appointment-btn")
            .addEventListener("click", function () {
              showAppointmentDetails(appointment.id);
            });
        });
      }

      // Display doctors list
      function displayDoctorsList() {
        const storedDoctors =
          JSON.parse(localStorage.getItem("hms_doctors")) || [];
        doctorsList.innerHTML = "";

        storedDoctors
          .filter((d) => d.active !== false)
          .forEach((doctor) => {
            const doctorItem = document.createElement("div");
            doctorItem.className =
              "doctor-item flex justify-between items-center p-3 border border-gray-200 rounded-md";
            doctorItem.innerHTML = `
                    <div>
                        <p class="font-medium text-gray-800">${doctor.name}</p>
                        <p class="text-sm text-gray-600">${doctor.specialtyName}</p>
                    </div>
                    <div class="flex space-x-2">
                        <button class="edit-doctor-btn text-blue-600 hover:text-blue-800" data-id="${doctor.id}">
                            Edit
                        </button>
                        <button class="toggle-doctor-btn text-blue-600 hover:text-blue-800" data-id="${doctor.id}">
                            Deactivate
                        </button>
                    </div>
                `;
            doctorsList.appendChild(doctorItem);

            // Add event listener to edit button
            doctorItem
              .querySelector(".edit-doctor-btn")
              .addEventListener("click", function () {
                editDoctor(doctor.id);
              });

            // Add event listener to toggle button
            doctorItem
              .querySelector(".toggle-doctor-btn")
              .addEventListener("click", function () {
                toggleDoctorStatus(doctor.id);
              });
          });
      }

      // Add new doctor
      function addNewDoctor() {
        const name = document.getElementById("doctor-name").value;
        const specialty = document.getElementById("doctor-specialty").value;
        const experience = document.getElementById("doctor-experience").value;
        const availability = [
          "avail-monday",
          "avail-tuesday",
          "avail-wednesday",
          "avail-thursday",
          "avail-friday",
          "avail-saturday",
        ]
          .filter((id) => document.getElementById(id).checked)
          .map(
            (id) =>
              id.replace("avail-", "").charAt(0).toUpperCase() +
              id.replace("avail-", "").slice(1)
          );

        const storedDoctors =
          JSON.parse(localStorage.getItem("hms_doctors")) || [];
        const newDoctor = {
          id:
            storedDoctors.length > 0
              ? Math.max(...storedDoctors.map((d) => d.id)) + 1
              : 1,
          name,
          specialty,
          specialtyName: specialty.charAt(0).toUpperCase() + specialty.slice(1),
          experience: parseInt(experience),
          image: createDoctorSVG(getRandomColor(), "male"),
          availability,
          timeSlots: [
            "09:00 AM",
            "10:00 AM",
            "11:00 AM",
            "02:00 PM",
            "03:00 PM",
            "04:00 PM",
          ],
          active: true,
        };

        storedDoctors.push(newDoctor);
        localStorage.setItem("hms_doctors", JSON.stringify(storedDoctors));
        addDoctorModal.classList.add("hidden");
        addDoctorForm.reset();
        document.getElementById("doctor-id").value = "";
        displayDoctorsList();
        updateDashboard();
      }

      // Edit doctor
      function editDoctor(doctorId) {
        const storedDoctors =
          JSON.parse(localStorage.getItem("hms_doctors")) || [];
        const doctor = storedDoctors.find((d) => d.id === parseInt(doctorId));
        if (!doctor) return;

        document.getElementById("doctor-modal-title").textContent =
          "Edit Doctor";
        submitDoctorBtn.textContent = "Save Changes";
        document.getElementById("doctor-id").value = doctor.id;
        document.getElementById("doctor-name").value = doctor.name;
        document.getElementById("doctor-specialty").value = doctor.specialty;
        document.getElementById("doctor-experience").value = doctor.experience;

        // Set availability checkboxes
        [
          "monday",
          "tuesday",
          "wednesday",
          "thursday",
          "friday",
          "saturday",
        ].forEach((day) => {
          const checkbox = document.getElementById(`avail-${day}`);
          checkbox.checked = doctor.availability.includes(
            day.charAt(0).toUpperCase() + day.slice(1)
          );
        });

        addDoctorModal.classList.remove("hidden");
      }

      // Update doctor
      function updateDoctor(doctorId) {
        const storedDoctors =
          JSON.parse(localStorage.getItem("hms_doctors")) || [];
        const doctor = storedDoctors.find((d) => d.id === parseInt(doctorId));
        if (!doctor) return;

        doctor.name = document.getElementById("doctor-name").value;
        doctor.specialty = document.getElementById("doctor-specialty").value;
        doctor.specialtyName =
          doctor.specialty.charAt(0).toUpperCase() + doctor.specialty.slice(1);
        doctor.experience = parseInt(
          document.getElementById("doctor-experience").value
        );
        doctor.availability = [
          "avail-monday",
          "avail-tuesday",
          "avail-wednesday",
          "avail-thursday",
          "avail-friday",
          "avail-saturday",
        ]
          .filter((id) => document.getElementById(id).checked)
          .map(
            (id) =>
              id.replace("avail-", "").charAt(0).toUpperCase() +
              id.replace("avail-", "").slice(1)
          );

        localStorage.setItem("hms_doctors", JSON.stringify(storedDoctors));
        addDoctorModal.classList.add("hidden");
        addDoctorForm.reset();
        document.getElementById("doctor-id").value = "";
        displayDoctorsList();
        updateDashboard();
      }

      // Toggle doctor status
      function toggleDoctorStatus(doctorId) {
        const storedDoctors =
          JSON.parse(localStorage.getItem("hms_doctors")) || [];
        const doctor = storedDoctors.find((d) => d.id === doctorId);
        if (doctor) {
          doctor.active = !doctor.active;
          localStorage.setItem("hms_doctors", JSON.stringify(storedDoctors));
          displayDoctorsList();
          updateDashboard();
        }
      }

      // Show appointment details
      function showAppointmentDetails(appointmentId) {
        const storedAppointments =
          JSON.parse(localStorage.getItem("hms_appointments")) || [];
        const storedDoctors =
          JSON.parse(localStorage.getItem("hms_doctors")) || [];
        const appointment = storedAppointments.find(
          (a) => a.id === appointmentId
        );
        if (!appointment) return;

        const doctor = storedDoctors.find((d) => d.id === appointment.doctorId);
        appointmentDetailsContent.innerHTML = `
                <div>
                    <p class="text-sm text-gray-600">Patient Name</p>
                    <p class="font-medium">${appointment.patientName}</p>
                </div>
                <div>
                    <p class="text-sm text-gray-600">Age</p>
                    <p class="font-medium">${appointment.patientAge}</p>
                </div>
                <div>
                    <p class="text-sm text-gray-600">Gender</p>
                    <p class="font-medium">${appointment.patientGender}</p>
                </div>
                <div>
                    <p class="text-sm text-gray-600">Phone</p>
                    <p class="font-medium">${appointment.patientPhone}</p>
                </div>
                <div>
                    <p class="text-sm text-gray-600">Doctor</p>
                    <p class="font-medium">${
                      doctor ? doctor.name : "Unknown"
                    }</p>
                </div>
                <div>
                    <p class="text-sm text-gray-600">Date</p>
                    <p class="font-medium">${formatDate(appointment.date)}</p>
                </div>
                <div>
                    <p class="text-sm text-gray-600">Time</p>
                    <p class="font-medium">${appointment.time}</p>
                </div>
                <div>
                    <p class="text-sm text-gray-600">Condition</p>
                    <p class="font-medium">${appointment.condition}</p>
                </div>
                <div>
                    <p class="text-sm text-gray-600">Status</p>
                    <select id="appointment-status" class="w-full px-4 py-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500">
                        <option value="Pending" ${
                          appointment.status === "Pending" ? "selected" : ""
                        }>Pending</option>
                        <option value="Confirmed" ${
                          appointment.status === "Confirmed" ? "selected" : ""
                        }>Confirmed</option>
                        <option value="Cancelled" ${
                          appointment.status === "Cancelled" ? "selected" : ""
                        }>Cancelled</option>
                    </select>
                </div>
            `;

        appointmentDetailsModal.classList.remove("hidden");

        // Add event listeners for action buttons
        document
          .getElementById("send-notification-btn")
          .addEventListener("click", function () {
            sendNotification(appointment);
          });

        document
          .getElementById("update-status-btn")
          .addEventListener("click", function () {
            updateAppointmentStatus(appointment.id);
          });

        document
          .getElementById("delete-appointment-btn")
          .addEventListener("click", function () {
            deleteAppointment(appointment.id);
          });
      }

      // Send notification
      function sendNotification(appointment) {
        const storedDoctors =
          JSON.parse(localStorage.getItem("hms_doctors")) || [];
        const doctor = storedDoctors.find((d) => d.id === appointment.doctorId);
        alert(
          `Notification sent to ${
            appointment.patientName
          } for appointment with ${
            doctor ? doctor.name : "Unknown"
          } on ${formatDate(appointment.date)} at ${appointment.time}`
        );
      }

      // Update appointment status
      function updateAppointmentStatus(appointmentId) {
        const storedAppointments =
          JSON.parse(localStorage.getItem("hms_appointments")) || [];
        const appointment = storedAppointments.find(
          (a) => a.id === appointmentId
        );
        if (appointment) {
          appointment.status =
            document.getElementById("appointment-status").value;
          localStorage.setItem(
            "hms_appointments",
            JSON.stringify(storedAppointments)
          );
          appointmentDetailsModal.classList.add("hidden");
          displayAppointments(filterDate.value);
          updateDashboard();
        }
      }

      // Delete appointment
      function deleteAppointment(appointmentId) {
        const storedAppointments =
          JSON.parse(localStorage.getItem("hms_appointments")) || [];
        const index = storedAppointments.findIndex(
          (a) => a.id === appointmentId
        );
        if (index !== -1) {
          storedAppointments.splice(index, 1);
          localStorage.setItem(
            "hms_appointments",
            JSON.stringify(storedAppointments)
          );
          appointmentDetailsModal.classList.add("hidden");
          displayAppointments(filterDate.value);
          updateDashboard();
        }
      }

      // Utility functions
      function getCurrentDate() {
        const today = new Date();
        return today.toISOString().split("T")[0];
      }

      function formatDate(dateString) {
        const date = new Date(dateString);
        return date.toLocaleDateString("en-US", {
          weekday: "long",
          year: "numeric",
          month: "long",
          day: "numeric",
        });
      }

      function createDoctorSVG(color, gender) {
        const hairStyle =
          gender === "female"
            ? `<path d="M32 16c0-8.837-7.163-16-16-16S0 7.163 0 16c0 6.03 3.182 11.135 7.68 13.83C9.87 35.307 15.576 38 22 38c8.284 0 15-6.716 15-15 0-3.02-.894-5.83-2.43-8.185C35.484 13.344 36 14.614 36 16c0 8.837-7.163 16-16 16S4 24.837 4 16 11.163 0 20 0c7.195 0 13.308 4.738 15.312 11.274C33.142 7.197 29.199 4 24.5 4c-6.351 0-11.5 5.149-11.5 11.5 0 2.52.81 4.85 2.184 6.738C18.141 23.322 21.085 24 24.5 24c6.351 0 11.5-5.149 11.5-11.5 0-.174-.004-.346-.012-.517C36.634 13.939 37 14.932 37 16c0 9.389-7.611 17-17 17S3 25.389 3 16 10.611-1 20-1c8.774 0 16.01 6.631 16.917 15.153C36.972 13.715 37 13.344 37 12.962 37 5.807 31.193 0 24.038 0c-5.077 0-9.438 2.931-11.558 7.18C14.398 6.142 17.264 5 20.5 5c6.351 0 11.5 5.149 11.5 11.5S26.851 28 20.5 28c-2.074 0-4.017-.55-5.698-1.511C16.595 28.041 18.737 29 21.076 29c5.76 0 10.424-4.674 10.424-10.435 0-2.926-1.195-5.567-3.125-7.467C30.533 9.25 33 10.336 33 12c0 1.657-1.343 3-3 3s-3-1.343-3-3c0-1.657 1.343-3 3-3 .159 0 .314.013.467.035C27.532 5.405 23.75 3 19.5 3 13.149 3 8 8.149 8 14.5S13.149 26 19.5 26c4.086 0 7.662-2.25 9.5-5.573" fill="${color}"/>`
            : `<path d="M18 2.5c-6.63 0-12 5.37-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C10.4 20.07 9.76 19.66 9.76 19.66c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C26.565 24.295 30 19.795 30 14.5c0-6.63-5.37-12-12-12" fill="${color}"/>`;

        return `<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 50 50" width="100" height="100">
                <circle cx="25" cy="25" r="20" fill="#f3f4f6"/>
                <g transform="translate(12, 10)">
                    ${hairStyle}
                </g>
            </svg>`;
      }

      function getRandomColor() {
        const colors = [
          "#3b82f6",
          "#10b981",
          "#6366f1",
          "#ec4899",
          "#f59e0b",
          "#8b5cf6",
        ];
        return colors[Math.floor(Math.random() * colors.length)];
      }
    </script>
  </body>
</html>
